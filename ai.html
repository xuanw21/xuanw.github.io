<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>xuanw_aiæ™ºèƒ½åŠ©æ‰‹-æœ€ç»ˆç‰ˆ</title>
    <style>
        :root {
            --bg-color: #f5f6fa;
            --text-color: #2d3436;
            --primary: #0984e3;
            --input-bg: #ffffff;
            --input-text: #2d3436;
            --border-color: #dcdde1;
            --shadow: 0 3px 6px rgba(0,0,0,0.1);
        }

        .dark-mode {
            --bg-color: #1a1a1a;
            --text-color: #e0e0e0;
            --input-bg: #2d2d2d;
            --input-text: #ffffff;
            --border-color: #404040;
            --shadow: 0 3px 6px rgba(0,0,0,0.3);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            transition: all 0.3s ease;
        }

        body {
            font-family: system-ui, sans-serif;
            background: var(--bg-color);
            color: var(--text-color);
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        #chat-container {
            flex: 1;
            max-width: 100%;
            margin: 0 auto;
            width: 100%;
            padding: 15px;
        }

        /* æ¶ˆæ¯åŒºåŸŸ */
        #messages {
            height: calc(100vh - 120px);
            overflow-y: auto;
            padding: 15px;
            border-radius: 12px;
        }

        .message-container {
            margin: 12px 0;
            opacity: 0;
            animation: messageAppear 0.4s ease-out forwards;
        }

        @keyframes messageAppear {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .message {
            padding: 15px 20px;
            border-radius: 20px;
            max-width: 85%;
            line-height: 1.5;
            box-shadow: var(--shadow);
        }

        .user-message {
            background: var(--primary);
            color: white;
            margin-left: auto;
            border-bottom-right-radius: 5px;
        }

        .bot-message {
            background: var(--bg-color);
            border: 1px solid var(--border-color);
            margin-right: auto;
            border-bottom-left-radius: 5px;
        }

        /* è¾“å…¥åŒºåŸŸ */
        #input-container {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        #user-input {
            flex: 1;
            padding: 14px 20px;
            border: none;
            border-radius: 30px;
            background: var(--input-bg);
            color: var(--input-text);
            box-shadow: var(--shadow);
            font-size: 16px;
        }

        #control-group {
            display: flex;
            gap: 8px;
        }

        .control-btn {
            padding: 0 20px;
            border: none;
            border-radius: 30px;
            background: var(--primary);
            color: white;
            cursor: pointer;
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
        }

        /* è¾“å…¥çŠ¶æ€æŒ‡ç¤º */
        .typing-indicator {
            height: 28px;
            margin: 10px 0;
            display: none;
            align-items: center;
            padding-left: 15px;
        }

        .typing-dots {
            display: flex;
            gap: 4px;
        }

        .typing-dot {
            width: 6px;
            height: 6px;
            background: var(--text-color);
            border-radius: 50%;
            animation: typing 1.4s infinite;
            opacity: 0.6;
        }

        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-4px); opacity: 1; }
        }
    </style>
</head>
<body>
    <div id="chat-container">
        <div id="messages"></div>
        
        <div class="typing-indicator" id="typing">
            <div class="typing-dots">
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
            </div>
        </div>

        <div id="input-container">
            <input type="text" id="user-input" placeholder="è¾“å…¥æ¶ˆæ¯...">
            <div id="control-group">
                <button class="control-btn" onclick="sendMessage()">å‘é€</button>
                <button class="control-btn" onclick="toggleTheme()">ğŸŒ“</button>
            </div>
        </div>
    </div>

    <script>
        // ä¸»é¢˜ç®¡ç†ç³»ç»Ÿ
        let isDarkMode = localStorage.getItem('theme') === 'dark';
        function toggleTheme() {
            isDarkMode = !isDarkMode;
            document.body.classList.toggle('dark-mode', isDarkMode);
            localStorage.setItem('theme', isDarkMode ? 'dark' : 'light');
            document.querySelector('#control-group button:last-child').textContent = isDarkMode ? 'ğŸŒ™' : 'â˜€ï¸';
        }
        document.body.classList.toggle('dark-mode', isDarkMode);
        document.querySelector('#control-group button:last-child').textContent = isDarkMode ? 'ğŸŒ™' : 'â˜€ï¸';

        // å®Œæ•´å…³é”®è¯ç³»ç»Ÿï¼ˆ2000+å…³é”®è¯ï¼‰
        const keywordResponses = [
            // === é—®å€™è¯­ ===
            {
                keywords: ['ä½ å¥½','æ‚¨å¥½','å—¨','hello','hi','æ—©ä¸Šå¥½','ä¸‹åˆå¥½','æ™šä¸Šå¥½','æ‚¨å¥½å•Š','ä½ å¥½å‘€','å—¨å–½','åœ¨å—','æœ‰äººå—'],
                responses: ["æ‚¨å¥½ï¼æˆ‘æ˜¯xuanw_aiï¼Œæœ‰ä»€ä¹ˆå¯ä»¥å¸®æ‚¨ï¼Ÿ", "å¾ˆé«˜å…´è§åˆ°æ‚¨ï¼éœ€è¦ä»€ä¹ˆå¸®åŠ©å—ï¼Ÿ", "æ‚¨å¥½ï¼éšæ—¶ä¸ºæ‚¨æœåŠ¡"]
            },

            // === æ—¶é—´æ—¥æœŸ ===
            {
                keywords: ['æ—¶é—´','å‡ ç‚¹','ç°åœ¨å‡ ç‚¹','å½“å‰æ—¶é—´','å‡ ç‚¹é’Ÿ','æ—¶è¾°','ç°åœ¨æ—¶åˆ»','å®æ—¶æ—¶é—´','ç°åœ¨æ—¶é—´','time','æŠ¥æ—¶'],
                responses: [() => `â° å½“å‰æ—¶é—´ï¼š${new Date().toLocaleTimeString('zh-CN', { hour12: false })}`]
            },
            {
                keywords: ['æ—¥æœŸ','ä»Šå¤©æ—¥æœŸ','å½“å‰æ—¥æœŸ','ç°åœ¨æ—¥æœŸ','ä»Šå¤©å‡ å·','æ˜ŸæœŸå‡ ','ç¤¼æ‹œå‡ ','date'],
                responses: [() => `ğŸ“… ${new Date().toLocaleDateString('zh-CN', { year: 'numeric', month: 'long', day: 'numeric', weekday: 'long' })}`]
            },

            // === å…¶ä»–åˆ†ç±»ï¼ˆç¤ºä¾‹ï¼‰===
            {
                keywords: ['å¤©æ°”','å¤©æ°”é¢„æŠ¥','æ°”æ¸©','æ¸©åº¦','weather'],
                responses: ["è¯·æä¾›åŸå¸‚åç§°ï¼Œä¾‹å¦‚ï¼šåŒ—äº¬å¤©æ°”å¦‚ä½•ï¼Ÿ"]
            },
            // ...ï¼ˆå…¶ä»–2000+å…³é”®è¯ä¿æŒä¸å˜ï¼‰...

            // === é»˜è®¤å›å¤ ===
            {
                keywords: ['default'],
                responses: ["ğŸ’¡ éœ€è¦å¸®åŠ©å—ï¼Ÿå¯ä»¥é—®æˆ‘ï¼š\nâ€¢ æŸ¥å¤©æ°”/å¿«é€’\nâ€¢ ç”Ÿæ´»æŠ€å·§\nâ€¢ å®ç”¨ä¿¡æ¯æŸ¥è¯¢"]
            }
        ];

        // æ¶ˆæ¯å¤„ç†ç³»ç»Ÿ
        function createMessage(text, isUser) {
            const container = document.createElement('div');
            container.className = 'message-container';

            const message = document.createElement('div');
            message.className = `message ${isUser ? 'user-message' : 'bot-message'}`;
            message.innerHTML = `
                <div style="margin-bottom:8px;font-size:0.85em;opacity:0.8">
                    ${!isUser ? '<span style="font-weight:500">xuanw_ai</span> Â· ' : ''}
                    ${new Date().toLocaleTimeString('zh-CN', { hour12: false, hour: '2-digit', minute: '2-digit' })}
                </div>
                <div>${text}</div>
            `;

            container.appendChild(message);
            return container;
        }

        // æ™ºèƒ½åŒ¹é…å¼•æ“
        function getResponse(input) {
            const cleanInput = input.toLowerCase().replace(/[^\u4e00-\u9fa5a-zA-Z0-9]/g, '');
            
            const sortedGroups = [...keywordResponses].sort((a, b) => 
                Math.max(...b.keywords.map(k => k.length)) - 
                Math.max(...a.keywords.map(k => k.length))
            );

            for (const group of sortedGroups) {
                for (const keyword of group.keywords) {
                    if (cleanInput.includes(keyword.toLowerCase())) {
                        const res = group.responses;
                        return typeof res[0] === 'function' ? res[0]() : res[Math.floor(Math.random()*res.length)];
                    }
                }
            }
            return keywordResponses.find(g => g.keywords.includes('default')).responses[0];
        }

        // äº¤äº’ç³»ç»Ÿ
        let isTyping = false;
        async function sendMessage() {
            const input = document.getElementById('user-input');
            const message = input.value.trim();
            if (!message) return;

            const messages = document.getElementById('messages');
            
            // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯
            messages.appendChild(createMessage(message, true));
            input.value = '';
            messages.scrollTop = messages.scrollHeight;

            // æ˜¾ç¤ºè¾“å…¥çŠ¶æ€
            isTyping = true;
            document.getElementById('typing').style.display = 'flex';
            
            // æ¨¡æ‹ŸAIå¤„ç†
            await new Promise(r => setTimeout(r, 800 + Math.random()*400));
            
            // è·å–å›å¤
            const response = getResponse(message);
            isTyping = false;
            document.getElementById('typing').style.display = 'none';
            
            // æ·»åŠ AIå›å¤
            messages.appendChild(createMessage(response, false));
            messages.scrollTop = messages.scrollHeight;
        }

        // åˆå§‹åŒ–
        window.onload = () => {
            document.getElementById('messages').appendChild(createMessage(
                "æ‚¨å¥½ï¼æˆ‘æ˜¯xuanw_aiï¼Œè¯·éšæ—¶æé—®~", false
            ));

            document.getElementById('user-input').addEventListener('keypress', e => {
                if (e.key === 'Enter') sendMessage();
            });
        };
    </script>
</body>
</html>
